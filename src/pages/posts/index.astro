---
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import PostsByYear from '../../components/PostsByYear.astro';
import TagCloud from '../../components/TagCloud.astro';

type BlogPost = CollectionEntry<'blog'>;
const title = 'All Posts';
const description = "Things I've been thinking about.";

const posts = await getCollection('blog')
	.then((posts) => posts.filter((post): post is BlogPost => post.data.listed !== false))
	.then((filteredPosts) => filteredPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()));
---

<BaseLayout title={title} description={description}>
	<div class='container'>
		<div class='mb-10 flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4'>
			<div class='flex-1'>
				<h1 class='text-3xl font-bold mb-2'>{title}</h1>
				<p class='text-zinc-700 dark:text-zinc-300 text-lg'>{description}</p>
			</div>
			<div class='sm:w-48 sm:text-right sm:mt-1'>
				<TagCloud />
			</div>
		</div>
		<PostsByYear posts={posts} />
	</div>
</BaseLayout>
